<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Rose Collect Game</title>

<style>
body{
  margin:0;
  font-family:sans-serif;
  background:#ffd6e7;
  color:#333;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
  overflow:hidden;
}

/* üå∏ ‡∏Å‡∏•‡∏µ‡∏ö‡∏•‡∏≠‡∏¢‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á */
.petal{
  position:fixed;
  top:-20px;
  font-size:18px;
  animation:petalFall linear forwards;
  pointer-events:none;
  opacity:.7;
}

@keyframes petalFall{
  to{
    transform:translateY(110vh) rotate(360deg);
  }
}

.scene{
  opacity:0;
  transform:scale(0.9);
  transition:opacity .5s, transform .5s;
  position:absolute;
  text-align:center;
  pointer-events:none;
  width:100%;
  height:100%;
}

.scene.active{
  opacity:1;
  transform:scale(1);
  position:relative;
  pointer-events:auto;
}

button{
  padding:12px 18px;
  margin:8px;
  border:none;
  border-radius:12px;
  font-size:16px;
  cursor:pointer;
  background:#fff;
}

.choice{
  display:block;
  width:240px;
}

#roseStart{
  font-size:70px;
  background:none;
  animation:pulse 1.6s infinite;
}

#gameArea{
  position:relative;
  width:100%;
  height:100%;
  overflow:hidden;
}

.fall{
  position:absolute;
  font-size:34px;
  animation:fall 3s linear forwards;
  user-select:none;
}

@keyframes fall{
  from{transform:translateY(-60px)}
  to{transform:translateY(110vh)}
}

@keyframes pulse{
  0%{transform:scale(1)}
  50%{transform:scale(1.15)}
  100%{transform:scale(1)}
}

.spark{
  position:absolute;
  font-size:20px;
  animation:spark .6s ease-out forwards;
  pointer-events:none;
}

@keyframes spark{
  from{opacity:1; transform:scale(1)}
  to{opacity:0; transform:scale(2) translateY(-20px)}
}
</style>
</head>

<body>

<!-- üîä ‡πÄ‡∏™‡∏µ‡∏¢‡∏á -->
<audio id="collectSound" preload="auto">
  <source src="https://cdn.jsdelivr.net/gh/jshawl/AudioFX/sounds/pop.mp3">
</audio>

<div id="sceneStart" class="scene active">
  <h2>‡∏Å‡∏î‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏°‡∏¥‡∏ô‡∏¥‡πÄ‡∏Å‡∏° üåπ</h2>
  <button id="roseStart">üåπ</button>
</div>

<div id="sceneCollect" class="scene">
  <h2>‡πÄ‡∏Å‡πá‡∏ö‡∏î‡∏≠‡∏Å‡πÑ‡∏°‡πâ‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö 10 üåπ‚ù§Ô∏è</h2>
  <div id="score">0 / 10</div>
  <div id="gameArea"></div>
</div>

<div id="sceneQuiz" class="scene">
  <h2 id="questionText"></h2>
  <div id="choices"></div>
</div>

<div id="sceneWin" class="scene">
  <h2>‡πÄ‡∏Å‡πà‡∏á‡∏°‡∏≤‡∏Å‡∏Å‡πÜ‡πÜ‡πÄ‡∏•‡∏¥‡∏¢ üíñ</h2>
  <button id="playAgainBtn">‡πÄ‡∏•‡πà‡∏ô‡πÉ‡∏´‡∏°‡πà</button>
</div>

<script>
function switchScene(from,to){
  document.getElementById(from).classList.remove("active");
  setTimeout(()=>document.getElementById(to).classList.add("active"),250);
}

/* üå∏ ‡∏Å‡∏•‡∏µ‡∏ö‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á */
function spawnPetal(){
  const p=document.createElement("div");
  p.className="petal";
  p.textContent="üå∏";
  p.style.left=Math.random()*100+"vw";
  p.style.animationDuration=(4+Math.random()*6)+"s";
  document.body.appendChild(p);
  setTimeout(()=>p.remove(),10000);
}
setInterval(spawnPetal,600);


/* ===== Game ===== */
let collected=0;
let spawnTimer;

function spawnFalling(){
  const area=document.getElementById("gameArea");
  const item=document.createElement("div");
  item.className="fall";
  item.textContent=Math.random()<0.5?"üåπ":"‚ù§Ô∏è";
  item.style.left=Math.random()*(area.clientWidth-40)+"px";

  function collect(e){
    if(item.clicked) return;
    item.clicked=true;

    collected++;
    document.getElementById("score").textContent=collected+" / 10";

    // üîä ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡∏á
    const s=document.getElementById("collectSound");
    s.currentTime=0;
    s.play();

    // ‚ú® ‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå
    const spark=document.createElement("div");
    spark.className="spark";
    spark.textContent="‚ú®";
    spark.style.left=(e.touches?e.touches[0].clientX:e.clientX)+"px";
    spark.style.top=(e.touches?e.touches[0].clientY:e.clientY)+"px";
    document.body.appendChild(spark);
    setTimeout(()=>spark.remove(),600);

    item.remove();

    if(collected>=10){
      clearInterval(spawnTimer);
      switchScene("sceneCollect","sceneQuiz");
      showQuestion();
    }
  }

  // ‚úÖ ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ + ‡πÄ‡∏°‡∏≤‡∏™‡πå
  item.addEventListener("click",collect);
  item.addEventListener("touchstart",collect);

  area.appendChild(item);
  setTimeout(()=>item.remove(),3000);
}


/* ===== Quiz ===== */
const quiz=[
  {q:"‡πÄ‡∏Ñ‡πâ‡∏≤‡πÄ‡∏Å‡∏¥‡∏î‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ó‡πà‡∏≤‡πÑ‡∏´‡∏£‡πà?",choices:["1 ‡∏°.‡∏Ñ.","14 ‡∏Å.‡∏û.","10 ‡∏ï.‡∏Ñ.","31 ‡∏ò.‡∏Ñ."],correct:1},
  {q:"‡πÄ‡∏Ñ‡πâ‡∏≤‡∏ä‡∏≠‡∏ö‡∏Å‡∏¥‡∏ô‡∏≠‡∏∞‡πÑ‡∏£?",choices:["‡∏û‡∏¥‡∏ã‡∏ã‡πà‡∏≤","‡∏ä‡∏≤‡∏ô‡∏°","‡∏™‡πâ‡∏°‡∏ï‡∏≥","‡∏ã‡∏π‡∏ä‡∏¥"],correct:0},
  {q:"‡πÄ‡∏Ñ‡πâ‡∏≤‡∏ä‡∏≠‡∏ö‡∏™‡∏µ‡∏≠‡∏∞‡πÑ‡∏£?",choices:["‡πÅ‡∏î‡∏á","‡∏ü‡πâ‡∏≤","‡∏ä‡∏°‡∏û‡∏π","‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß"],correct:2},
  {q:"‡πÄ‡∏Ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏ä‡∏≠‡∏ö‡∏≠‡∏∞‡πÑ‡∏£?",choices:["‡πÅ‡∏°‡∏ß","‡∏ù‡∏ô","‡∏Ç‡∏≠‡∏á‡πÄ‡∏ú‡πá‡∏î","‡∏ï‡∏∑‡πà‡∏ô‡πÄ‡∏ä‡πâ‡∏≤"],correct:3}
];

let index=0;

function showQuestion(){
  const data=quiz[index];
  const box=document.getElementById("choices");
  box.innerHTML="";
  document.getElementById("questionText").textContent=data.q;

  data.choices.forEach((c,i)=>{
    const btn=document.createElement("button");
    btn.textContent=c;
    btn.className="choice";
    btn.onclick=()=>answer(i);
    box.appendChild(btn);
  });
}

function answer(i){
  if(i!==quiz[index].correct){
    alert("‡∏ï‡∏≠‡∏ö‡∏ú‡∏¥‡∏î üòù");
    restart();
    return;
  }
  index++;
  if(index>=quiz.length){
    switchScene("sceneQuiz","sceneWin");
  }else showQuestion();
}


/* ===== Start ===== */
document.getElementById("roseStart").onclick=()=>{
  collected=0;
  index=0;
  document.getElementById("score").textContent="0 / 10";
  document.getElementById("gameArea").innerHTML="";
  switchScene("sceneStart","sceneCollect");
  spawnTimer=setInterval(spawnFalling,700);
};

function restart(){
  index=0;
  collected=0;
  switchScene("sceneWin","sceneStart");
}

document.getElementById("playAgainBtn").onclick=restart;

</script>
</body>
</html>
